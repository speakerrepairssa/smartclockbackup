<!DOCTYPE html>
<html>
<head>
    <title>Firebase Connection Test</title>
</head>
<body>
    <h1>Firebase Connection Test</h1>
    <button onclick="testFirebase()">Test Firebase Connection</button>
    <div id="result"></div>

    <script type="module">
        import { db } from '../config/firebase.js';
        import { collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        window.testFirebase = async function() {
            try {
                document.getElementById('result').innerHTML = '<p>Testing Firebase connection...</p>';
                
                // Test basic connection by trying to read businesses collection
                const businessesRef = collection(db, "businesses");
                const querySnapshot = await getDocs(businessesRef);
                
                document.getElementById('result').innerHTML = `
                    <h3>✅ Firebase Connection Working!</h3>
                    <p><strong>Database:</strong> Connected successfully</p>
                    <p><strong>Businesses found:</strong> ${querySnapshot.size}</p>
                    <ul>
                    ${querySnapshot.docs.map(doc => `<li>${doc.id} - ${doc.data().businessName || 'No name'}</li>`).join('')}
                    </ul>
                `;
                
                console.log("Firebase connection successful", { 
                    businessCount: querySnapshot.size,
                    businesses: querySnapshot.docs.map(doc => ({ id: doc.id, data: doc.data() }))
                });
            } catch (error) {
                console.error("Firebase connection error:", error);
                document.getElementById('result').innerHTML = `
                    <h3>❌ Firebase Connection Failed!</h3>
                    <p style="color: red;"><strong>Error:</strong> ${error.message}</p>
                    <p><strong>Error Code:</strong> ${error.code || 'N/A'}</p>
                `;
            }
        }
    </script>
</body>
</html>